
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanremo - Eisproduktionsmanagement</title>
    <style>
        /* ===== VARIABLES & RESET ===== */
        :root {
            /* Colors */
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #16a34a;
            --success-dark: #15803d;
            --danger: #dc2626;
            --danger-dark: #b91c1c;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --muted: #6b7280;
            --light: #f9fafb;
            --dark: #1f2937;
            --border: #e5e7eb;
            --border-dark: #d1d5db;
            --card-bg: #ffffff;
            --body-bg: #f3f4f6;
            
            /* Spacing */
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
            --radius-xl: 18px;
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.1);
            
            /* Typography */
            --font-size-xs: 12px;
            --font-size-sm: 14px;
            --font-size-md: 16px;
            --font-size-lg: 18px;
            --font-size-xl: 20px;
            --font-size-2xl: 24px;
            --font-size-3xl: 30px;
            
            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-slow: 350ms ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.5;
            overflow-x: hidden;
        }
        
        /* ===== LAYOUT ===== */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
            background: var(--light);
            box-shadow: var(--shadow-xl);
        }
        
        /* ===== HEADER ===== */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: var(--space-md) var(--space-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .logo-icon {
            font-size: 28px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .logo-text {
            font-size: var(--font-size-xl);
            font-weight: 800;
            letter-spacing: -0.5px;
        }
        
        .logo-subtitle {
            font-size: var(--font-size-sm);
            opacity: 0.9;
            font-weight: 500;
        }
        
        /* ===== MAIN NAVIGATION ===== */
        .main-nav {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.1);
            padding: var(--space-sm);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
        }
        
        .nav-btn {
            padding: var(--space-sm) var(--space-md);
            background: transparent;
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            color: white;
            font-weight: 700;
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            white-space: nowrap;
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow-md);
        }
        
        .nav-btn i {
            font-size: 18px;
        }
        
        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            padding: var(--space-lg);
            overflow-y: auto;
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .view-container {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .view-container.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== DASHBOARD VIEW ===== */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .stat-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border);
            transition: all var(--transition-normal);
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: var(--space-md);
        }
        
        .stat-icon.order { background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%); color: white; }
        .stat-icon.production { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: white; }
        .stat-icon.recipe { background: linear-gradient(135deg, #34d399 0%, #10b981 100%); color: white; }
        .stat-icon.label { background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%); color: white; }
        
        .stat-value {
            font-size: var(--font-size-2xl);
            font-weight: 800;
            color: var(--dark);
            margin: var(--space-xs) 0;
        }
        
        .stat-label {
            color: var(--muted);
            font-size: var(--font-size-sm);
            font-weight: 600;
        }
        
        .stat-change {
            font-size: var(--font-size-xs);
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 20px;
            margin-top: var(--space-sm);
            display: inline-block;
        }
        
        .stat-change.positive { background: #dcfce7; color: #166534; }
        .stat-change.negative { background: #fee2e2; color: #991b1b; }
        
        /* ===== COMMON COMPONENTS ===== */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border);
            margin-bottom: var(--space-lg);
        }
        
        .card-title {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--dark);
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .card-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: var(--space-md);
        }
        
        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            font-weight: 600;
            color: var(--dark);
            font-size: var(--font-size-sm);
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-size: var(--font-size-md);
            transition: all var(--transition-fast);
            background: white;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            text-decoration: none;
        }
        
        .btn i {
            font-size: 16px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, var(--danger-dark) 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, var(--warning-dark) 100%);
            color: white;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--border-dark);
            color: var(--dark);
        }
        
        .btn-outline:hover {
            background: var(--light);
            border-color: var(--primary);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: var(--font-size-xs);
        }
        
        .btn-icon {
            padding: 8px;
            border-radius: var(--radius-sm);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .btn-icon:hover {
            background: var(--light);
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: var(--font-size-xs);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-primary {
            background: #dbeafe;
            color: var(--primary-dark);
        }
        
        .badge-success {
            background: #dcfce7;
            color: var(--success-dark);
        }
        
        .badge-warning {
            background: #fef3c7;
            color: var(--warning-dark);
        }
        
        .badge-danger {
            background: #fee2e2;
            color: var(--danger-dark);
        }
        
        .alert {
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .alert-success {
            background: #dcfce7;
            border: 1px solid #86efac;
            color: #166534;
        }
        
        .alert-warning {
            background: #fef3c7;
            border: 1px solid #fcd34d;
            color: #92400e;
        }
        
        .alert-danger {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            color: #991b1b;
        }
        
        .alert-info {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            color: #1e40af;
        }
        
        .alert-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .alert-content {
            flex: 1;
        }
        
        /* ===== TABLES ===== */
        .table-container {
            overflow-x: auto;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            margin-bottom: var(--space-lg);
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        .table th {
            background: var(--light);
            padding: 12px 16px;
            text-align: left;
            font-weight: 700;
            font-size: var(--font-size-sm);
            color: var(--dark);
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
        }
        
        .table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            font-size: var(--font-size-sm);
        }
        
        .table tr:last-child td {
            border-bottom: none;
        }
        
        .table tr:hover {
            background: #f8fafc;
        }
        
        .table-actions {
            display: flex;
            gap: var(--space-xs);
        }
        
        /* ===== ORDER MANAGEMENT ===== */
        .order-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .order-items-container {
            background: white;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            overflow: hidden;
        }
        
        .order-item {
            display: grid;
            grid-template-columns: 1fr 1fr 100px 60px;
            gap: var(--space-md);
            padding: var(--space-md);
            border-bottom: 1px solid var(--border);
            align-items: center;
        }
        
        .order-item:last-child {
            border-bottom: none;
        }
        
        .order-summary {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--light);
            border-radius: var(--radius-md);
            margin-top: var(--space-lg);
        }
        
        .summary-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--space-md);
            background: white;
            border-radius: var(--radius-md);
            min-width: 120px;
            box-shadow: var(--shadow-sm);
        }
        
        .summary-value {
            font-size: var(--font-size-2xl);
            font-weight: 800;
            color: var(--primary);
        }
        
        .summary-label {
            font-size: var(--font-size-xs);
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 700;
        }
        
        /* ===== PRODUCTION VIEW ===== */
        .production-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .production-tile {
            background: white;
            border-radius: var(--radius-md);
            padding: var(--space-md);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
            transition: all var(--transition-fast);
        }
        
        .production-tile:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .production-value {
            font-size: var(--font-size-2xl);
            font-weight: 800;
            color: var(--dark);
            margin: var(--space-sm) 0;
        }
        
        .production-label {
            font-size: var(--font-size-sm);
            color: var(--muted);
            font-weight: 600;
        }
        
        /* ===== RECIPE VIEW ===== */
        .ingredients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .ingredient-card {
            background: white;
            border-radius: var(--radius-md);
            padding: var(--space-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
        }
        
        .ingredient-name {
            font-size: var(--font-size-md);
            font-weight: 700;
            color: var(--dark);
            margin-bottom: var(--space-sm);
        }
        
        .ingredient-meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            margin-bottom: var(--space-md);
        }
        
        .nutrition-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
        }
        
        .nutrition-item {
            padding: var(--space-xs) var(--space-sm);
            background: var(--light);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
        }
        
        .nutrition-label {
            color: var(--muted);
            font-weight: 600;
        }
        
        .nutrition-value {
            color: var(--dark);
            font-weight: 700;
        }
        
        /* ===== PRINT STYLES ===== */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ccc !important;
                page-break-inside: avoid;
            }
        }
        
        /* ===== UTILITIES ===== */
        .d-flex { display: flex; }
        .d-none { display: none; }
        .flex-column { flex-direction: column; }
        .align-items-center { align-items: center; }
        .justify-content-between { justify-content: space-between; }
        .gap-1 { gap: var(--space-xs); }
        .gap-2 { gap: var(--space-sm); }
        .gap-3 { gap: var(--space-md); }
        .gap-4 { gap: var(--space-lg); }
        .mt-1 { margin-top: var(--space-xs); }
        .mt-2 { margin-top: var(--space-sm); }
        .mt-3 { margin-top: var(--space-md); }
        .mt-4 { margin-top: var(--space-lg); }
        .mb-1 { margin-bottom: var(--space-xs); }
        .mb-2 { margin-bottom: var(--space-sm); }
        .mb-3 { margin-bottom: var(--space-md); }
        .mb-4 { margin-bottom: var(--space-lg); }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-muted { color: var(--muted); }
        .text-success { color: var(--success); }
        .text-danger { color: var(--danger); }
        .text-warning { color: var(--warning); }
        .text-primary { color: var(--primary); }
        .fw-bold { font-weight: 700; }
        .fw-bolder { font-weight: 800; }
        .fs-sm { font-size: var(--font-size-sm); }
        .fs-md { font-size: var(--font-size-md); }
        .fs-lg { font-size: var(--font-size-lg); }
        .w-100 { width: 100%; }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .app-container {
                border-radius: 0;
            }
            
            .app-header {
                flex-direction: column;
                gap: var(--space-md);
                padding: var(--space-md);
            }
            
            .main-nav {
                width: 100%;
                overflow-x: auto;
                padding: var(--space-sm);
            }
            
            .nav-btn {
                font-size: var(--font-size-xs);
                padding: 8px 12px;
            }
            
            .main-content {
                padding: var(--space-md);
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .production-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .order-form-grid {
                grid-template-columns: 1fr;
            }
            
            .order-item {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
        }
        
        @media (max-width: 480px) {
            .production-stats {
                grid-template-columns: 1fr;
            }
            
            .ingredients-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-item {
                min-width: 100px;
            }
        }
    </style>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- HEADER -->
        <header class="app-header no-print">
            <div class="logo">
                <div class="logo-icon">üç®</div>
                <div>
                    <div class="logo-text">Sanremo Eisproduktion</div>
                    <div class="logo-subtitle">Komplettes Produktionsmanagement</div>
                </div>
            </div>
            
            <nav class="main-nav">
                <button class="nav-btn active" data-view="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button class="nav-btn" data-view="orders">
                    <i class="fas fa-shopping-cart"></i> Bestellungen
                </button>
                <button class="nav-btn" data-view="production">
                    <i class="fas fa-industry"></i> Produktion
                </button>
                <button class="nav-btn" data-view="recipes">
                    <i class="fas fa-book"></i> Rezepte
                </button>
                <button class="nav-btn" data-view="labels">
                    <i class="fas fa-tag"></i> Etiketten
                </button>
                <button class="nav-btn" data-view="customers">
                    <i class="fas fa-users"></i> Kunden
                </button>
                <button class="nav-btn" data-view="statistics">
                    <i class="fas fa-chart-bar"></i> Statistik
                </button>
                <button class="nav-btn" data-view="settings">
                    <i class="fas fa-cog"></i> Einstellungen
                </button>
            </nav>
        </header>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- DASHBOARD VIEW -->
            <section id="dashboard-view" class="view-container active">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-icon order">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="stat-value" id="stat-today-orders">0</div>
                            <div class="stat-label">Heutige Bestellungen</div>
                            <div class="stat-change positive">+12%</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon production">
                                <i class="fas fa-industry"></i>
                            </div>
                            <div class="stat-value" id="stat-production-today">0 kg</div>
                            <div class="stat-label">Heutige Produktion</div>
                            <div class="stat-change positive">+8%</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon recipe">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="stat-value" id="stat-recipes">0</div>
                            <div class="stat-label">Aktive Rezepte</div>
                            <div class="stat-change negative">-2%</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon label">
                                <i class="fas fa-tag"></i>
                            </div>
                            <div class="stat-value" id="stat-labels-today">0</div>
                            <div class="stat-label">Etiketten heute</div>
                            <div class="stat-change positive">+15%</div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <div class="alert-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="alert-content">
                            <strong>Willkommen!</strong> Heute haben Sie 3 offene Bestellungen und 45kg Produktion geplant.
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-calendar-alt"></i> Heutige Aktivit√§ten
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Zeit</th>
                                    <th>Aktivit√§t</th>
                                    <th>Status</th>
                                    <th>Aktion</th>
                                </tr>
                            </thead>
                            <tbody id="today-activities">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ORDERS VIEW -->
            <section id="orders-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-shopping-cart"></i> Bestellverwaltung
                    </div>
                    
                    <div class="order-form-grid">
                        <div class="form-group">
                            <label class="form-label">Kunde</label>
                            <select class="form-select" id="order-customer">
                                <option value="">Kunde ausw√§hlen...</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Lieferdatum</label>
                            <input type="date" class="form-input" id="order-date">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Priorit√§t</label>
                            <select class="form-select" id="order-priority">
                                <option value="normal">Normal</option>
                                <option value="high">Hoch</option>
                                <option value="urgent">Dringend</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notizen</label>
                        <textarea class="form-textarea" id="order-notes" placeholder="Besondere Anweisungen..."></textarea>
                    </div>
                    
                    <div class="d-flex gap-3 mb-4">
                        <button class="btn btn-primary" id="add-order-item">
                            <i class="fas fa-plus"></i> Position hinzuf√ºgen
                        </button>
                        <button class="btn btn-outline" id="clear-order">
                            <i class="fas fa-trash"></i> Leeren
                        </button>
                    </div>
                    
                    <div class="order-items-container mb-3">
                        <div class="order-item fw-bold" style="background: var(--light);">
                            <div>Sorte</div>
                            <div>Gr√∂√üe</div>
                            <div>Menge</div>
                            <div>Aktion</div>
                        </div>
                        <div id="order-items-list">
                            <!-- Order items will be added here -->
                        </div>
                    </div>
                    
                    <div class="order-summary">
                        <div class="summary-item">
                            <div class="summary-value" id="total-items">0</div>
                            <div class="summary-label">Positionen</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="total-750g">0</div>
                            <div class="summary-label">750g</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="total-170g">0</div>
                            <div class="summary-label">170g</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="total-kg">0.0</div>
                            <div class="summary-label">KG</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="total-buckets">0</div>
                            <div class="summary-label">Eimer</div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mt-4">
                        <button class="btn btn-success" id="save-order">
                            <i class="fas fa-save"></i> Bestellung speichern
                        </button>
                        <button class="btn btn-primary" id="print-order">
                            <i class="fas fa-print"></i> Drucken
                        </button>
                        <button class="btn btn-warning" id="export-order">
                            <i class="fas fa-file-export"></i> Exportieren
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-history"></i> Letzte Bestellungen
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Datum</th>
                                    <th>Kunde</th>
                                    <th>Menge</th>
                                    <th>Status</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody id="recent-orders">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- PRODUCTION VIEW -->
            <section id="production-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-industry"></i> Produktionsplanung
                    </div>
                    
                    <div class="production-stats">
                        <div class="production-tile">
                            <div class="production-label">Heutige Produktion</div>
                            <div class="production-value" id="prod-today-kg">0 kg</div>
                            <div class="badge badge-success">Geplant</div>
                        </div>
                        
                        <div class="production-tile">
                            <div class="production-label">Eimer ben√∂tigt</div>
                            <div class="production-value" id="prod-buckets-needed">0</div>
                            <div class="badge badge-primary">6kg/Eimer</div>
                        </div>
                        
                        <div class="production-tile">
                            <div class="production-label">Fertiggestellt</div>
                            <div class="production-value" id="prod-completed">0%</div>
                            <div class="badge badge-success">Fortschritt</div>
                        </div>
                        
                        <div class="production-tile">
                            <div class="production-label">Offene Bestellungen</div>
                            <div class="production-value" id="prod-open-orders">0</div>
                            <div class="badge badge-warning">Zu bearbeiten</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Datum f√ºr Produktionsplan</label>
                        <input type="date" class="form-input" id="production-date" value="">
                    </div>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Sorte</th>
                                    <th>750g</th>
                                    <th>170g</th>
                                    <th>KG</th>
                                    <th>Eimer</th>
                                    <th>Status</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody id="production-plan">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <button class="btn btn-primary" id="generate-production-plan">
                            <i class="fas fa-calculator"></i> Plan generieren
                        </button>
                        <button class="btn btn-success" id="start-production">
                            <i class="fas fa-play"></i> Produktion starten
                        </button>
                        <button class="btn btn-warning" id="print-production-plan">
                            <i class="fas fa-print"></i> Plan drucken
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i> Produktionsfortschritt
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Sorte</th>
                                    <th>Geplant (KG)</th>
                                    <th>Produziert (KG)</th>
                                    <th>Fortschritt</th>
                                    <th>Letzte Aktualisierung</th>
                                </tr>
                            </thead>
                            <tbody id="production-progress">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- RECIPES VIEW -->
            <section id="recipes-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-book"></i> Rezeptverwaltung
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Sorte ausw√§hlen oder neue erstellen</label>
                        <div class="d-flex gap-3">
                            <select class="form-select" id="recipe-flavor">
                                <option value="">Sorte ausw√§hlen...</option>
                            </select>
                            <button class="btn btn-primary" id="new-recipe">
                                <i class="fas fa-plus"></i> Neue Sorte
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group" id="recipe-form" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Name der Sorte</label>
                            <input type="text" class="form-input" id="recipe-name" placeholder="z.B. Vanille, Schokolade...">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Produkttyp</label>
                            <select class="form-select" id="recipe-type">
                                <option value="milcheis">Milcheis</option>
                                <option value="sorbet">Sorbet</option>
                                <option value="fruchteis">Fruchteis</option>
                                <option value="speiseeis">Speiseeis</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Beschreibung</label>
                            <textarea class="form-textarea" id="recipe-description" placeholder="Kurze Beschreibung der Sorte..."></textarea>
                        </div>
                        
                        <div class="card-title mt-4">
                            <i class="fas fa-list"></i> Zutaten
                        </div>
                        
                        <div id="ingredients-list">
                            <!-- Ingredients will be added here -->
                        </div>
                        
                        <button class="btn btn-outline w-100 mt-3" id="add-ingredient">
                            <i class="fas fa-plus"></i> Zutat hinzuf√ºgen
                        </button>
                        
                        <div class="card-title mt-4">
                            <i class="fas fa-chart-pie"></i> N√§hrwertberechnung
                        </div>
                        
                        <div class="nutrition-grid" id="nutrition-values">
                            <!-- Nutrition values will be calculated -->
                        </div>
                        
                        <div class="d-flex gap-3 mt-4">
                            <button class="btn btn-success" id="save-recipe">
                                <i class="fas fa-save"></i> Rezept speichern
                            </button>
                            <button class="btn btn-outline" id="cancel-recipe">
                                <i class="fas fa-times"></i> Abbrechen
                            </button>
                        </div>
                    </div>
                    
                    <div class="card" id="recipe-list-card">
                        <div class="card-title">
                            <i class="fas fa-list-ul"></i> Alle Rezepte
                        </div>
                        <div class="ingredients-grid" id="recipes-list">
                            <!-- Recipe cards will be added here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- LABELS VIEW -->
            <section id="labels-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-tag"></i> Etiketten-Generator
                    </div>
                    
                    <div class="order-form-grid">
                        <div class="form-group">
                            <label class="form-label">Sorte</label>
                            <select class="form-select" id="label-flavor">
                                <option value="">Sorte ausw√§hlen...</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Packungsgr√∂√üe</label>
                            <select class="form-select" id="label-size">
                                <option value="170">170 g</option>
                                <option value="500">500 g</option>
                                <option value="750">750 g</option>
                                <option value="1000">1000 g</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Chargen-Nummer</label>
                            <input type="text" class="form-input" id="label-batch" placeholder="z.B. 2024-03-15-001">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">MHD (Mindesthaltbarkeitsdatum)</label>
                            <input type="date" class="form-input" id="label-expiry">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Besondere Hinweise</label>
                        <textarea class="form-textarea" id="label-notes" placeholder="Besondere Lagerhinweise oder Allergene..."></textarea>
                    </div>
                    
                    <div class="alert alert-warning" id="label-warnings" style="display: none;">
                        <div class="alert-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="alert-content" id="warning-content">
                            <!-- Warnings will appear here -->
                        </div>
                    </div>
                    
                    <div class="card mt-4" id="label-preview-card">
                        <div class="card-title">
                            <i class="fas fa-eye"></i> Etikett-Vorschau
                        </div>
                        <div class="label-preview" id="label-preview">
                            <!-- Label preview will be generated here -->
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mt-4">
                        <button class="btn btn-primary" id="generate-label">
                            <i class="fas fa-sync"></i> Vorschau aktualisieren
                        </button>
                        <button class="btn btn-success" id="print-label">
                            <i class="fas fa-print"></i> Etikett drucken
                        </button>
                        <button class="btn btn-warning" id="print-batch">
                            <i class="fas fa-print"></i> Charge drucken (10x)
                        </button>
                        <button class="btn btn-outline" id="export-label">
                            <i class="fas fa-download"></i> Als PDF exportieren
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-history"></i> Zuletzt gedruckte Etiketten
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Datum</th>
                                    <th>Sorte</th>
                                    <th>Gr√∂√üe</th>
                                    <th>Charge</th>
                                    <th>Menge</th>
                                    <th>Aktion</div>
                                </tr>
                            </thead>
                            <tbody id="recent-labels">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- CUSTOMERS VIEW -->
            <section id="customers-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-users"></i> Kundenverwaltung
                    </div>
                    
                    <div class="order-form-grid">
                        <div class="form-group">
                            <label class="form-label">Kundenname</label>
                            <input type="text" class="form-input" id="customer-name" placeholder="z.B. REWE, EDEKA...">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Filiale / Standort</label>
                            <input type="text" class="form-input" id="customer-location" placeholder="z.B. Bad Berleburg, Hauptstra√üe 1">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Kontaktperson</label>
                            <input type="text" class="form-input" id="customer-contact" placeholder="Name der Kontaktperson">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Telefon</label>
                            <input type="tel" class="form-input" id="customer-phone" placeholder="Telefonnummer">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">E-Mail</label>
                            <input type="email" class="form-input" id="customer-email" placeholder="E-Mail-Adresse">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Kundentyp</label>
                            <select class="form-select" id="customer-type">
                                <option value="supermarkt">Supermarkt</option>
                                <option value="restaurant">Restaurant</option>
                                <option value="cafe">Caf√©</option>
                                <option value="grosshandel">Gro√ühandel</option>
                                <option value="privat">Privatkunde</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notizen</label>
                        <textarea class="form-textarea" id="customer-notes" placeholder="Besondere Vereinbarungen, Lieferzeiten..."></textarea>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <button class="btn btn-success" id="save-customer">
                            <i class="fas fa-save"></i> Kunden speichern
                        </button>
                        <button class="btn btn-outline" id="clear-customer-form">
                            <i class="fas fa-times"></i> Formular leeren
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-address-book"></i> Kundenliste
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Standort</th>
                                    <th>Kontakt</th>
                                    <th>Typ</th>
                                    <th>Letzte Bestellung</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody id="customers-list">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- STATISTICS VIEW -->
            <section id="statistics-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-bar"></i> Statistik & Berichte
                    </div>
                    
                    <div class="order-form-grid">
                        <div class="form-group">
                            <label class="form-label">Zeitraum</label>
                            <select class="form-select" id="stat-period">
                                <option value="today">Heute</option>
                                <option value="week">Diese Woche</option>
                                <option value="month" selected>Dieser Monat</option>
                                <option value="quarter">Dieses Quartal</option>
                                <option value="year">Dieses Jahr</option>
                                <option value="custom">Benutzerdefiniert</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="custom-date-range" style="display: none;">
                            <div class="d-flex gap-3">
                                <div style="flex: 1;">
                                    <label class="form-label">Von</label>
                                    <input type="date" class="form-input" id="stat-from">
                                </div>
                                <div style="flex: 1;">
                                    <label class="form-label">Bis</label>
                                    <input type="date" class="form-input" id="stat-to">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Berichtstyp</label>
                            <select class="form-select" id="stat-type">
                                <option value="sales">Verk√§ufe</option>
                                <option value="production">Produktion</option>
                                <option value="customers">Kunden</option>
                                <option value="recipes">Rezepte</option>
                                <option value="inventory">Bestand</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mb-4">
                        <button class="btn btn-primary" id="generate-report">
                            <i class="fas fa-chart-line"></i> Bericht generieren
                        </button>
                        <button class="btn btn-success" id="export-report">
                            <i class="fas fa-file-excel"></i> Als Excel exportieren
                        </button>
                        <button class="btn btn-warning" id="print-report">
                            <i class="fas fa-print"></i> Bericht drucken
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Metrik</th>
                                    <th>Wert</th>
                                    <th>√Ñnderung</th>
                                    <th>Trend</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="statistics-data">
                                <!-- Statistics will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="card mt-4">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i> Umsatz nach Sorte
                        </div>
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Sorte</th>
                                        <th>Menge (kg)</th>
                                        <th>Umsatz (‚Ç¨)</th>
                                        <th>Anteil</th>
                                        <th>Trend</th>
                                    </tr>
                                </thead>
                                <tbody id="flavor-stats">
                                    <!-- Flavor statistics will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SETTINGS VIEW -->
            <section id="settings-view" class="view-container">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-cog"></i> Systemeinstellungen
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Unternehmensname</label>
                        <input type="text" class="form-input" id="company-name" value="Eiscaf√© Sanremo">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Adresse</label>
                        <textarea class="form-textarea" id="company-address" rows="2">Bad Berleburg</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Telefon</label>
                        <input type="tel" class="form-input" id="company-phone" value="0176 72809926">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Standard-Eisgr√∂√üen</label>
                        <div class="d-flex gap-3">
                            <input type="number" class="form-input" id="size-170" value="170" min="1" placeholder="170">
                            <input type="number" class="form-input" id="size-500" value="500" min="1" placeholder="500">
                            <input type="number" class="form-input" id="size-750" value="750" min="1" placeholder="750">
                            <input type="number" class="form-input" id="size-1000" value="1000" min="1" placeholder="1000">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Eimer-Gr√∂√üe (kg)</label>
                        <input type="number" class="form-input" id="bucket-size" value="6" min="1" step="0.5">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Standard-MHD (Tage)</label>
                        <input type="number" class="form-input" id="default-expiry" value="180" min="1">
                    </div>
                    
                    <div class="card-title mt-4">
                        <i class="fas fa-database"></i> Datenverwaltung
                    </div>
                    
                    <div class="d-flex gap-3">
                        <button class="btn btn-outline" id="backup-data">
                            <i class="fas fa-download"></i> Backup erstellen
                        </button>
                        <button class="btn btn-outline" id="restore-data">
                            <i class="fas fa-upload"></i> Backup wiederherstellen
                        </button>
                        <button class="btn btn-danger" id="reset-data">
                            <i class="fas fa-trash"></i> Daten zur√ºcksetzen
                        </button>
                    </div>
                    
                    <div class="alert alert-warning mt-4">
                        <div class="alert-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="alert-content">
                            <strong>Warnung:</strong> Das Zur√ºcksetzen der Daten kann nicht r√ºckg√§ngig gemacht werden. Erstellen Sie vorher ein Backup.
                        </div>
                    </div>
                    
                    <div class="card-title mt-4">
                        <i class="fas fa-paint-brush"></i> Darstellung
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Design</label>
                        <select class="form-select" id="theme-select">
                            <option value="light">Hell</option>
                            <option value="dark">Dunkel</option>
                            <option value="auto">Automatisch</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Sprache</label>
                        <select class="form-select" id="language-select">
                            <option value="de" selected>Deutsch</option>
                            <option value="en">English</option>
                            <option value="pt">Portugu√™s</option>
                        </select>
                    </div>
                    
                    <div class="d-flex gap-3 mt-4">
                        <button class="btn btn-success" id="save-settings">
                            <i class="fas fa-save"></i> Einstellungen speichern
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- FOOTER -->
        <footer class="app-footer no-print" style="padding: var(--space-md); background: var(--light); border-top: 1px solid var(--border); text-align: center; color: var(--muted); font-size: var(--font-size-sm);">
            <div class="d-flex justify-content-between align-items-center">
                <div>¬© 2024 Eiscaf√© Sanremo - Alle Rechte vorbehalten</div>
                <div>
                    <span id="current-time">--:--</span> | 
                    <span id="data-status" class="badge badge-success">Daten gespeichert</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- MODALS -->
    <div id="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
        <div id="modal-content" style="background: white; border-radius: var(--radius-lg); padding: var(--space-xl); max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <!-- Modal content will be injected here -->
        </div>
    </div>

    <!-- TEMPLATES (Hidden) -->
    <div id="templates" style="display: none;">
        <!-- Order Item Template -->
        <div class="order-item-template">
            <select class="form-select order-flavor">
                <option value="">Sorte w√§hlen...</option>
            </select>
            <select class="form-select order-size">
                <option value="170">170 g</option>
                <option value="750">750 g</option>
                <option value="1000">1000 g</option>
            </select>
            <input type="number" class="form-input order-quantity" value="1" min="1" max="100">
            <button class="btn btn-danger btn-sm remove-item">
                <i class="fas fa-trash"></i>
            </button>
        </div>
        
        <!-- Recipe Card Template -->
        <div class="recipe-card-template">
            <div class="ingredient-card">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <div class="ingredient-name">Vanille</div>
                    <div class="d-flex gap-1">
                        <button class="btn-icon edit-recipe">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon delete-recipe">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="ingredient-meta">
                    <span class="badge badge-primary">Milcheis</span>
                    <span class="badge badge-success">4 Zutaten</span>
                </div>
                <div class="nutrition-grid">
                    <div class="nutrition-item">
                        <div class="nutrition-label">Energie</div>
                        <div class="nutrition-value">850 kJ</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Fett</div>
                        <div class="nutrition-value">8.5g</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Label Preview Template -->
        <div class="label-preview-template">
            <div style="border: 2px solid #333; padding: 20px; border-radius: 8px; background: white; max-width: 400px; margin: 0 auto;">
                <div style="text-align: center; border-bottom: 1px solid #ccc; padding-bottom: 10px; margin-bottom: 15px;">
                    <div style="font-size: 18px; font-weight: bold;">MILCHEIS - VANILLE</div>
                    <div style="font-size: 12px; color: #666;">Nettof√ºllmenge: 750 g</div>
                </div>
                <div style="font-size: 11px; line-height: 1.4;">
                    <div><strong>Zutaten:</strong> Vollmilch, Sahne, Zucker, Eigelb, Vanilleextrakt</div>
                    <div style="margin-top: 8px;"><strong>Allergene:</strong> Milch, Ei</div>
                    <div style="margin-top: 8px;"><strong>MHD:</strong> 15.03.2024</div>
                    <div style="margin-top: 8px;"><strong>Charge:</strong> 2024-03-15-001</div>
                </div>
                <div style="text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px solid #ccc;">
                    <div style="font-size: 10px;">Eiscaf√© Sanremo ‚Ä¢ Bad Berleburg ‚Ä¢ Tel: 0176 72809926</div>
                </div>
            </div>
        </div>
        
        <!-- Customer Row Template -->
        <tr class="customer-row-template">
            <td class="customer-name">REWE</td>
            <td class="customer-location">Bad Berleburg</td>
            <td class="customer-contact">Herr M√ºller</td>
            <td>
                <span class="badge badge-primary customer-type">Supermarkt</span>
            </td>
            <td class="customer-last-order">15.03.2024</td>
            <td>
                <div class="table-actions">
                    <button class="btn-icon edit-customer">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn-icon delete-customer">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </td>
        </tr>
    </div>

    <script>
        // ===== DATABASE MANAGEMENT =====
        const DB = {
            VERSION: '1.0.0',
            KEYS: {
                ORDERS: 'sanremo_orders',
                CUSTOMERS: 'sanremo_customers',
                RECIPES: 'sanremo_recipes',
                INGREDIENTS: 'sanremo_ingredients',
                PRODUCTION: 'sanremo_production',
                SETTINGS: 'sanremo_settings',
                STATISTICS: 'sanremo_statistics'
            },
            
            // Initialize all data
            init() {
                // Initialize empty databases if they don't exist
                if (!localStorage.getItem(this.KEYS.ORDERS)) {
                    localStorage.setItem(this.KEYS.ORDERS, JSON.stringify([]));
                }
                if (!localStorage.getItem(this.KEYS.CUSTOMERS)) {
                    localStorage.setItem(this.KEYS.CUSTOMERS, JSON.stringify([
                        {
                            id: '1',
                            name: 'REWE',
                            location: 'Bad Berleburg',
                            contact: 'Herr Schmidt',
                            phone: '02751 12345',
                            email: 'rewe@example.com',
                            type: 'supermarkt',
                            notes: 'Lieferung bis 09:00 Uhr',
                            created: new Date().toISOString()
                        },
                        {
                            id: '2',
                            name: 'EDEKA',
                            location: 'Bad Berleburg',
                            contact: 'Frau Meyer',
                            phone: '02751 67890',
                            email: 'edeka@example.com',
                            type: 'supermarkt',
                            notes: 'Hintereingang nutzen',
                            created: new Date().toISOString()
                        }
                    ]));
                }
                if (!localStorage.getItem(this.KEYS.RECIPES)) {
                    localStorage.setItem(this.KEYS.RECIPES, JSON.stringify([]));
                }
                if (!localStorage.getItem(this.KEYS.INGREDIENTS)) {
                    localStorage.setItem(this.KEYS.INGREDIENTS, JSON.stringify([
                        {
                            id: '1',
                            name: 'Vollmilch 3,5%',
                            category: 'milchprodukte',
                            allergens: ['MILCH'],
                            nutrition: {
                                energy_kj: 267,
                                energy_kcal: 64,
                                fat: 3.5,
                                saturated_fat: 2.4,
                                carbs: 4.8,
                                sugar: 4.8,
                                protein: 3.3,
                                salt: 0.1
                            },
                            unit: 'g',
                            price_per_unit: 0.012
                        },
                        {
                            id: '2',
                            name: 'Zucker',
                            category: 'zucker',
                            allergens: [],
                            nutrition: {
                                energy_kj: 1700,
                                energy_kcal: 405,
                                fat: 0,
                                saturated_fat: 0,
                                carbs: 100,
                                sugar: 100,
                                protein: 0,
                                salt: 0
                            },
                            unit: 'g',
                            price_per_unit: 0.001
                        }
                    ]));
                }
                if (!localStorage.getItem(this.KEYS.PRODUCTION)) {
                    localStorage.setItem(this.KEYS.PRODUCTION, JSON.stringify([]));
                }
                if (!localStorage.getItem(this.KEYS.SETTINGS)) {
                    localStorage.setItem(this.KEYS.SETTINGS, JSON.stringify({
                        company_name: 'Eiscaf√© Sanremo',
                        company_address: 'Bad Berleburg',
                        company_phone: '0176 72809926',
                        sizes: [170, 500, 750, 1000],
                        bucket_size: 6,
                        default_expiry_days: 180,
                        theme: 'light',
                        language: 'de'
                    }));
                }
                if (!localStorage.getItem(this.KEYS.STATISTICS)) {
                    localStorage.setItem(this.KEYS.STATISTICS, JSON.stringify([]));
                }
            },
            
            // Generic get method
            get(key) {
                try {
                    return JSON.parse(localStorage.getItem(key)) || [];
                } catch (e) {
                    console.error('Error reading from localStorage:', e);
                    return [];
                }
            },
            
            // Generic set method
            set(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('Error writing to localStorage:', e);
                    return false;
                }
            },
            
            // Get all orders
            getOrders() {
                return this.get(this.KEYS.ORDERS);
            },
            
            // Save an order
            saveOrder(order) {
                const orders = this.getOrders();
                order.id = order.id || 'order_' + Date.now();
                order.created = order.created || new Date().toISOString();
                order.updated = new Date().toISOString();
                orders.push(order);
                return this.set(this.KEYS.ORDERS, orders);
            },
            
            // Get all customers
            getCustomers() {
                return this.get(this.KEYS.CUSTOMERS);
            },
            
            // Save a customer
            saveCustomer(customer) {
                const customers = this.getCustomers();
                customer.id = customer.id || 'customer_' + Date.now();
                customer.created = customer.created || new Date().toISOString();
                customer.updated = new Date().toISOString();
                customers.push(customer);
                return this.set(this.KEYS.CUSTOMERS, customers);
            },
            
            // Delete a customer
            deleteCustomer(id) {
                const customers = this.getCustomers();
                const filtered = customers.filter(c => c.id !== id);
                return this.set(this.KEYS.CUSTOMERS, filtered);
            },
            
            // Get all recipes
            getRecipes() {
                return this.get(this.KEYS.RECIPES);
            },
            
            // Save a recipe
            saveRecipe(recipe) {
                const recipes = this.getRecipes();
                recipe.id = recipe.id || 'recipe_' + Date.now();
                recipe.created = recipe.created || new Date().toISOString();
                recipe.updated = new Date().toISOString();
                recipes.push(recipe);
                return this.set(this.KEYS.RECIPES, recipes);
            },
            
            // Get settings
            getSettings() {
                return this.get(this.KEYS.SETTINGS);
            },
            
            // Save settings
            saveSettings(settings) {
                return this.set(this.KEYS.SETTINGS, settings);
            },
            
            // Backup all data
            backup() {
                const backup = {
                    version: this.VERSION,
                    timestamp: new Date().toISOString(),
                    orders: this.getOrders(),
                    customers: this.getCustomers(),
                    recipes: this.getRecipes(),
                    ingredients: this.get(this.KEYS.INGREDIENTS),
                    production: this.get(this.KEYS.PRODUCTION),
                    settings: this.getSettings(),
                    statistics: this.get(this.KEYS.STATISTICS)
                };
                return JSON.stringify(backup, null, 2);
            },
            
            // Restore from backup
            restore(backupData) {
                try {
                    const backup = JSON.parse(backupData);
                    
                    // Validate backup structure
                    if (!backup.version || !backup.timestamp) {
                        throw new Error('Invalid backup format');
                    }
                    
                    // Restore each database
                    this.set(this.KEYS.ORDERS, backup.orders || []);
                    this.set(this.KEYS.CUSTOMERS, backup.customers || []);
                    this.set(this.KEYS.RECIPES, backup.recipes || []);
                    this.set(this.KEYS.INGREDIENTS, backup.ingredients || []);
                    this.set(this.KEYS.PRODUCTION, backup.production || []);
                    this.set(this.KEYS.SETTINGS, backup.settings || {});
                    this.set(this.KEYS.STATISTICS, backup.statistics || []);
                    
                    return true;
                } catch (e) {
                    console.error('Error restoring backup:', e);
                    return false;
                }
            }
        };

        // ===== UTILITY FUNCTIONS =====
        const Utils = {
            // Format date to German format
            formatDate(date, includeTime = false) {
                const d = new Date(date);
                const day = d.getDate().toString().padStart(2, '0');
                const month = (d.getMonth() + 1).toString().padStart(2, '0');
                const year = d.getFullYear();
                
                if (includeTime) {
                    const hours = d.getHours().toString().padStart(2, '0');
                    const minutes = d.getMinutes().toString().padStart(2, '0');
                    return `${day}.${month}.${year} ${hours}:${minutes}`;
                }
                
                return `${day}.${month}.${year}`;
            },
            
            // Calculate weight in kg
            calculateWeight(size, quantity) {
                const sizeMap = {
                    '170': 0.170,
                    '500': 0.500,
                    '750': 0.750,
                    '1000': 1.000
                };
                return (sizeMap[size] || 0) * quantity;
            },
            
            // Calculate number of buckets needed
            calculateBuckets(totalKg, bucketSize = 6) {
                return Math.ceil(totalKg / bucketSize);
            },
            
            // Show notification
            showNotification(message, type = 'info') {
                // Remove existing notifications
                const existing = document.querySelector('.notification');
                if (existing) existing.remove();
                
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification alert alert-${type}`;
                notification.innerHTML = `
                    <div class="alert-icon">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : type === 'danger' ? 'times-circle' : 'info-circle'}"></i>
                    </div>
                    <div class="alert-content">${message}</div>
                `;
                
                // Add to body
                document.body.appendChild(notification);
                
                // Position it
                notification.style.position = 'fixed';
                notification.style.top = '20px';
                notification.style.right = '20px';
                notification.style.zIndex = '3000';
                notification.style.maxWidth = '400px';
                notification.style.boxShadow = 'var(--shadow-lg)';
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100px)';
                    setTimeout(() => notification.remove(), 300);
                }, 5000);
            },
            
            // Show modal
            showModal(title, content, buttons = []) {
                const overlay = document.getElementById('modal-overlay');
                const modalContent = document.getElementById('modal-content');
                
                // Build modal HTML
                let html = `
                    <div class="card-title" style="margin-bottom: var(--space-lg);">
                        <i class="fas fa-info-circle"></i> ${title}
                    </div>
                    <div style="margin-bottom: var(--space-lg);">
                        ${content}
                    </div>
                `;
                
                // Add buttons if provided
                if (buttons.length > 0) {
                    html += '<div class="d-flex gap-3 justify-content-end">';
                    buttons.forEach(btn => {
                        html += `<button class="btn btn-${btn.type}" id="modal-btn-${btn.id}">${btn.label}</button>`;
                    });
                    html += '</div>';
                } else {
                    html += '<div class="text-center"><button class="btn btn-primary" id="modal-close">OK</button></div>';
                }
                
                modalContent.innerHTML = html;
                overlay.style.display = 'flex';
                
                // Add event listeners
                if (buttons.length > 0) {
                    buttons.forEach(btn => {
                        document.getElementById(`modal-btn-${btn.id}`).onclick = () => {
                            btn.onClick();
                            overlay.style.display = 'none';
                        };
                    });
                } else {
                    document.getElementById('modal-close').onclick = () => {
                        overlay.style.display = 'none';
                    };
                }
                
                // Close on overlay click
                overlay.onclick = (e) => {
                    if (e.target === overlay) {
                        overlay.style.display = 'none';
                    }
                };
            },
            
            // Generate unique ID
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }
        };

        // ===== APPLICATION STATE =====
        const AppState = {
            currentView: 'dashboard',
            currentOrder: {
                customerId: '',
                date: '',
                priority: 'normal',
                notes: '',
                items: []
            },
            currentRecipe: null,
            currentCustomer: null
        };

        // ===== VIEW MANAGER =====
        const ViewManager = {
            init() {
                // Set up navigation buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const view = btn.getAttribute('data-view');
                        this.switchView(view);
                    });
                });
                
                // Initialize all views
                this.switchView('dashboard');
            },
            
            switchView(viewName) {
                // Update active button
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.getAttribute('data-view') === viewName);
                });
                
                // Hide all views
                document.querySelectorAll('.view-container').forEach(view => {
                    view.classList.remove('active');
                });
                
                // Show selected view
                const targetView = document.getElementById(`${viewName}-view`);
                if (targetView) {
                    targetView.classList.add('active');
                    AppState.currentView = viewName;
                    
                    // Initialize view-specific content
                    this.initView(viewName);
                }
            },
            
            initView(viewName) {
                switch(viewName) {
                    case 'dashboard':
                        Dashboard.init();
                        break;
                    case 'orders':
                        Orders.init();
                        break;
                    case 'production':
                        Production.init();
                        break;
                    case 'recipes':
                        Recipes.init();
                        break;
                    case 'labels':
                        Labels.init();
                        break;
                    case 'customers':
                        Customers.init();
                        break;
                    case 'statistics':
                        Statistics.init();
                        break;
                    case 'settings':
                        Settings.init();
                        break;
                }
            }
        };

        // ===== DASHBOARD MODULE =====
        const Dashboard = {
            init() {
                this.updateStatistics();
                this.loadTodayActivities();
                
                // Update time every minute
                setInterval(() => this.updateTime(), 60000);
                this.updateTime();
            },
            
            updateStatistics() {
                const orders = DB.getOrders();
                const today = new Date().toISOString().split('T')[0];
                
                // Today's orders
                const todayOrders = orders.filter(o => o.date === today);
                document.getElementById('stat-today-orders').textContent = todayOrders.length;
                
                // Today's production (calculate from orders)
                let todayProduction = 0;
                todayOrders.forEach(order => {
                    order.items?.forEach(item => {
                        todayProduction += Utils.calculateWeight(item.size, item.quantity);
                    });
                });
                document.getElementById('stat-production-today').textContent = todayProduction.toFixed(1) + ' kg';
                
                // Recipe count
                const recipes = DB.getRecipes();
                document.getElementById('stat-recipes').textContent = recipes.length;
                
                // Labels printed today (placeholder)
                document.getElementById('stat-labels-today').textContent = todayOrders.length * 3; // Estimate
            },
            
            loadTodayActivities() {
                const activities = [
                    {
                        time: '08:00',
                        activity: 'Tagesproduktion starten',
                        status: 'In Bearbeitung',
                        action: 'Fortsetzen'
                    },
                    {
                        time: '09:30',
                        activity: 'Lieferung an REWE',
                        status: 'Erledigt',
                        action: 'Details'
                    },
                    {
                        time: '11:00',
                        activity: 'Neue Bestellung: EDEKA',
                        status: 'Ausstehend',
                        action: 'Bearbeiten'
                    },
                    {
                        time: '14:00',
                        activity: 'Qualit√§tskontrolle',
                        status: 'Geplant',
                        action: 'Planen'
                    }
                ];
                
                const tbody = document.getElementById('today-activities');
                tbody.innerHTML = '';
                
                activities.forEach(activity => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${activity.time}</td>
                        <td>${activity.activity}</td>
                        <td><span class="badge ${activity.status === 'Erledigt' ? 'badge-success' : activity.status === 'In Bearbeitung' ? 'badge-warning' : 'badge-primary'}">${activity.status}</span></td>
                        <td><button class="btn btn-sm btn-outline">${activity.action}</button></td>
                    `;
                    tbody.appendChild(tr);
                });
            },
            
            updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('de-DE', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                document.getElementById('current-time').textContent = timeString;
            }
        };

        // ===== ORDERS MODULE =====
        const Orders = {
            init() {
                this.loadCustomers();
                this.setDefaultDate();
                this.setupEventListeners();
                this.loadRecentOrders();
            },
            
            loadCustomers() {
                const customers = DB.getCustomers();
                const select = document.getElementById('order-customer');
                select.innerHTML = '<option value="">Kunde ausw√§hlen...</option>';
                
                customers.forEach(customer => {
                    const option = document.createElement('option');
                    option.value = customer.id;
                    option.textContent = `${customer.name} - ${customer.location}`;
                    select.appendChild(option);
                });
            },
            
            setDefaultDate() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('order-date').value = today;
            },
            
            setupEventListeners() {
                // Add order item
                document.getElementById('add-order-item').addEventListener('click', () => {
                    this.addOrderItem();
                });
                
                // Clear order
                document.getElementById('clear-order').addEventListener('click', () => {
                    AppState.currentOrder = {
                        customerId: '',
                        date: '',
                        priority: 'normal',
                        notes: '',
                        items: []
                    };
                    this.renderOrderItems();
                    this.updateOrderSummary();
                });
                
                // Save order
                document.getElementById('save-order').addEventListener('click', () => {
                    this.saveOrder();
                });
                
                // Print order
                document.getElementById('print-order').addEventListener('click', () => {
                    this.printOrder();
                });
                
                // Export order
                document.getElementById('export-order').addEventListener('click', () => {
                    this.exportOrder();
                });
            },
            
            addOrderItem() {
                const item = {
                    id: Utils.generateId(),
                    flavor: '',
                    size: '750',
                    quantity: 1
                };
                AppState.currentOrder.items.push(item);
                this.renderOrderItems();
            },
            
            renderOrderItems() {
                const container = document.getElementById('order-items-list');
                container.innerHTML = '';
                
                AppState.currentOrder.items.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'order-item';
                    div.innerHTML = `
                        <select class="form-select order-flavor" data-index="${index}">
                            <option value="">Sorte w√§hlen...</option>
                            <option value="vanille">Vanille</option>
                            <option value="schokolade">Schokolade</option>
                            <option value="erdbeer">Erdbeer</option>
                            <option value="zitrone">Zitrone</option>
                            <option value="stracciatella">Stracciatella</option>
                        </select>
                        <select class="form-select order-size" data-index="${index}">
                            <option value="170">170 g</option>
                            <option value="750" selected>750 g</option>
                            <option value="1000">1000 g</option>
                        </select>
                        <input type="number" class="form-input order-quantity" 
                               data-index="${index}" value="${item.quantity}" min="1" max="100">
                        <button class="btn btn-danger btn-sm remove-item" data-index="${index}">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    
                    // Set selected values
                    div.querySelector('.order-flavor').value = item.flavor;
                    div.querySelector('.order-size').value = item.size;
                    
                    container.appendChild(div);
                });
                
                // Add event listeners to new elements
                this.addItemEventListeners();
                this.updateOrderSummary();
            },
            
            addItemEventListeners() {
                // Flavor change
                document.querySelectorAll('.order-flavor').forEach(select => {
                    select.addEventListener('change', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        AppState.currentOrder.items[index].flavor = e.target.value;
                    });
                });
                
                // Size change
                document.querySelectorAll('.order-size').forEach(select => {
                    select.addEventListener('change', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        AppState.currentOrder.items[index].size = e.target.value;
                        this.updateOrderSummary();
                    });
                });
                
                // Quantity change
                document.querySelectorAll('.order-quantity').forEach(input => {
                    input.addEventListener('change', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        AppState.currentOrder.items[index].quantity = parseInt(e.target.value) || 1;
                        this.updateOrderSummary();
                    });
                });
                
                // Remove item
                document.querySelectorAll('.remove-item').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = parseInt(e.target.closest('button').getAttribute('data-index'));
                        AppState.currentOrder.items.splice(index, 1);
                        this.renderOrderItems();
                    });
                });
            },
            
            updateOrderSummary() {
                let totalItems = 0;
                let total750g = 0;
                let total170g = 0;
                let totalKg = 0;
                
                AppState.currentOrder.items.forEach(item => {
                    totalItems += item.quantity;
                    if (item.size === '750') total750g += item.quantity;
                    if (item.size === '170') total170g += item.quantity;
                    totalKg += Utils.calculateWeight(item.size, item.quantity);
                });
                
                const bucketSize = DB.getSettings().bucket_size || 6;
                const totalBuckets = Utils.calculateBuckets(totalKg, bucketSize);
                
                document.getElementById('total-items').textContent = totalItems;
                document.getElementById('total-750g').textContent = total750g;
                document.getElementById('total-170g').textContent = total170g;
                document.getElementById('total-kg').textContent = totalKg.toFixed(1);
                document.getElementById('total-buckets').textContent = totalBuckets;
            },
            
            saveOrder() {
                // Get form values
                const customerId = document.getElementById('order-customer').value;
                const date = document.getElementById('order-date').value;
                const priority = document.getElementById('order-priority').value;
                const notes = document.getElementById('order-notes').value;
                
                // Validate
                if (!customerId) {
                    Utils.showNotification('Bitte einen Kunden ausw√§hlen', 'warning');
                    return;
                }
                
                if (!date) {
                    Utils.showNotification('Bitte ein Lieferdatum ausw√§hlen', 'warning');
                    return;
                }
                
                if (AppState.currentOrder.items.length === 0) {
                    Utils.showNotification('Bitte mindestens eine Position hinzuf√ºgen', 'warning');
                    return;
                }
                
                // Create order object
                const order = {
                    customerId,
                    date,
                    priority,
                    notes,
                    items: [...AppState.currentOrder.items],
                    status: 'pending',
                    created: new Date().toISOString()
                };
                
                // Save to database
                if (DB.saveOrder(order)) {
                    Utils.showNotification('Bestellung erfolgreich gespeichert', 'success');
                    
                    // Reset form
                    AppState.currentOrder = {
                        customerId: '',
                        date: '',
                        priority: 'normal',
                        notes: '',
                        items: []
                    };
                    this.renderOrderItems();
                    this.updateOrderSummary();
                    document.getElementById('order-notes').value = '';
                    
                    // Reload recent orders
                    this.loadRecentOrders();
                    
                    // Update dashboard
                    Dashboard.updateStatistics();
                } else {
                    Utils.showNotification('Fehler beim Speichern der Bestellung', 'danger');
                }
            },
            
            loadRecentOrders() {
                const orders = DB.getOrders();
                const customers = DB.getCustomers();
                
                // Sort by date (newest first)
                orders.sort((a, b) => new Date(b.created) - new Date(a.created));
                
                const tbody = document.getElementById('recent-orders');
                tbody.innerHTML = '';
                
                // Show last 5 orders
                orders.slice(0, 5).forEach(order => {
                    const customer = customers.find(c => c.id === order.customerId);
                    const totalQuantity = order.items.reduce((sum, item) => sum + item.quantity, 0);
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${Utils.formatDate(order.date)}</td>
                        <td>${customer ? customer.name : 'Unbekannt'}</td>
                        <td>${totalQuantity} Stk.</td>
                        <td>
                            <span class="badge ${order.status === 'completed' ? 'badge-success' : order.status === 'pending' ? 'badge-warning' : 'badge-primary'}">
                                ${order.status === 'completed' ? 'Erledigt' : order.status === 'pending' ? 'Ausstehend' : 'In Bearbeitung'}
                            </span>
                        </td>
                        <td>
                            <div class="table-actions">
                                <button class="btn-icon view-order" data-id="${order.id}">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn-icon edit-order" data-id="${order.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon delete-order" data-id="${order.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
                
                // Add event listeners
                this.addOrderActionListeners();
            },
            
            addOrderActionListeners() {
                // View order
                document.querySelectorAll('.view-order').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const orderId = e.target.closest('button').getAttribute('data-id');
                        this.viewOrder(orderId);
                    });
                });
                
                // Edit order
                document.querySelectorAll('.edit-order').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const orderId = e.target.closest('button').getAttribute('data-id');
                        this.editOrder(orderId);
                    });
                });
                
                // Delete order
                document.querySelectorAll('.delete-order').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const orderId = e.target.closest('button').getAttribute('data-id');
                        this.deleteOrder(orderId);
                    });
                });
            },
            
            viewOrder(orderId) {
                const orders = DB.getOrders();
                const order = orders.find(o => o.id === orderId);
                
                if (order) {
                    let content = `
                        <h3>Bestelldetails</h3>
                        <p><strong>Datum:</strong> ${Utils.formatDate(order.date)}</p>
                        <p><strong>Status:</strong> ${order.status}</p>
                        <p><strong>Priorit√§t:</strong> ${order.priority}</p>
                        <p><strong>Notizen:</strong> ${order.notes || 'Keine'}</p>
                        <h4>Positionen:</h4>
                        <ul>
                    `;
                    
                    order.items.forEach(item => {
                        content += `<li>${item.quantity}x ${item.flavor} (${item.size}g)</li>`;
                    });
                    
                    content += '</ul>';
                    
                    Utils.showModal('Bestelldetails', content, [
                        {
                            id: 'close',
                            label: 'Schlie√üen',
                            type: 'primary',
                            onClick: () => {}
                        }
                    ]);
                }
            },
            
            editOrder(orderId) {
                Utils.showNotification('Bearbeitungsfunktion in Entwicklung', 'info');
            },
            
            deleteOrder(orderId) {
                Utils.showModal('Bestellung l√∂schen', 
                    'Sind Sie sicher, dass Sie diese Bestellung l√∂schen m√∂chten? Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden.',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'delete',
                            label: 'L√∂schen',
                            type: 'danger',
                            onClick: () => {
                                const orders = DB.getOrders();
                                const filtered = orders.filter(o => o.id !== orderId);
                                DB.set(DB.KEYS.ORDERS, filtered);
                                this.loadRecentOrders();
                                Utils.showNotification('Bestellung gel√∂scht', 'success');
                            }
                        }
                    ]);
            },
            
            printOrder() {
                Utils.showNotification('Druckfunktion in Entwicklung', 'info');
            },
            
            exportOrder() {
                Utils.showNotification('Exportfunktion in Entwicklung', 'info');
            }
        };

        // ===== PRODUCTION MODULE =====
        const Production = {
            init() {
                this.setDefaultDate();
                this.setupEventListeners();
                this.updateProductionStats();
            },
            
            setDefaultDate() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('production-date').value = today;
            },
            
            setupEventListeners() {
                // Generate production plan
                document.getElementById('generate-production-plan').addEventListener('click', () => {
                    this.generateProductionPlan();
                });
                
                // Start production
                document.getElementById('start-production').addEventListener('click', () => {
                    this.startProduction();
                });
                
                // Print production plan
                document.getElementById('print-production-plan').addEventListener('click', () => {
                    this.printProductionPlan();
                });
                
                // Date change
                document.getElementById('production-date').addEventListener('change', () => {
                    this.updateProductionStats();
                });
            },
            
            updateProductionStats() {
                const date = document.getElementById('production-date').value;
                const orders = DB.getOrders();
                
                // Filter orders for selected date
                const dateOrders = orders.filter(o => o.date === date);
                
                // Calculate totals
                let totalKg = 0;
                let total750g = 0;
                let total170g = 0;
                let openOrders = 0;
                
                dateOrders.forEach(order => {
                    if (order.status !== 'completed') openOrders++;
                    
                    order.items?.forEach(item => {
                        totalKg += Utils.calculateWeight(item.size, item.quantity);
                        if (item.size === '750') total750g += item.quantity;
                        if (item.size === '170') total170g += item.quantity;
                    });
                });
                
                const bucketSize = DB.getSettings().bucket_size || 6;
                const bucketsNeeded = Utils.calculateBuckets(totalKg, bucketSize);
                const completedPercent = dateOrders.length > 0 ? 
                    Math.round((dateOrders.filter(o => o.status === 'completed').length / dateOrders.length) * 100) : 0;
                
                // Update display
                document.getElementById('prod-today-kg').textContent = totalKg.toFixed(1) + ' kg';
                document.getElementById('prod-buckets-needed').textContent = bucketsNeeded;
                document.getElementById('prod-completed').textContent = completedPercent + '%';
                document.getElementById('prod-open-orders').textContent = openOrders;
            },
            
            generateProductionPlan() {
                const date = document.getElementById('production-date').value;
                const orders = DB.getOrders();
                
                // Filter and aggregate by flavor
                const flavorMap = {};
                
                orders
                    .filter(o => o.date === date)
                    .forEach(order => {
                        order.items?.forEach(item => {
                            if (!flavorMap[item.flavor]) {
                                flavorMap[item.flavor] = {
                                    flavor: item.flavor,
                                    size750: 0,
                                    size170: 0,
                                    kg: 0
                                };
                            }
                            
                            flavorMap[item.flavor].kg += Utils.calculateWeight(item.size, item.quantity);
                            if (item.size === '750') flavorMap[item.flavor].size750 += item.quantity;
                            if (item.size === '170') flavorMap[item.flavor].size170 += item.quantity;
                        });
                    });
                
                // Convert to array and sort by kg
                const flavors = Object.values(flavorMap)
                    .sort((a, b) => b.kg - a.kg);
                
                // Render table
                const tbody = document.getElementById('production-plan');
                tbody.innerHTML = '';
                
                flavors.forEach(flavor => {
                    const bucketSize = DB.getSettings().bucket_size || 6;
                    const buckets = Utils.calculateBuckets(flavor.kg, bucketSize);
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${flavor.flavor || 'Unbekannt'}</strong></td>
                        <td>${flavor.size750}</td>
                        <td>${flavor.size170}</td>
                        <td>${flavor.kg.toFixed(2)} kg</td>
                        <td>${buckets} Eimer</td>
                        <td>
                            <span class="badge badge-warning">Geplant</span>
                        </td>
                        <td>
                            <div class="table-actions">
                                <button class="btn-icon start-flavor" data-flavor="${flavor.flavor}">
                                    <i class="fas fa-play"></i>
                                </button>
                                <button class="btn-icon complete-flavor" data-flavor="${flavor.flavor}">
                                    <i class="fas fa-check"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
                
                // Add event listeners
                this.addFlavorActionListeners();
                
                Utils.showNotification('Produktionsplan generiert', 'success');
            },
            
            addFlavorActionListeners() {
                // Start flavor production
                document.querySelectorAll('.start-flavor').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const flavor = e.target.closest('button').getAttribute('data-flavor');
                        this.startFlavorProduction(flavor);
                    });
                });
                
                // Complete flavor production
                document.querySelectorAll('.complete-flavor').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const flavor = e.target.closest('button').getAttribute('data-flavor');
                        this.completeFlavorProduction(flavor);
                    });
                });
            },
            
            startFlavorProduction(flavor) {
                Utils.showNotification(`Produktion von ${flavor} gestartet`, 'success');
            },
            
            completeFlavorProduction(flavor) {
                Utils.showNotification(`Produktion von ${flavor} abgeschlossen`, 'success');
            },
            
            startProduction() {
                Utils.showModal('Produktion starten',
                    'M√∂chten Sie die Produktion f√ºr den heutigen Tag starten? Dies wird den Status aller Bestellungen auf "In Bearbeitung" setzen.',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'start',
                            label: 'Produktion starten',
                            type: 'success',
                            onClick: () => {
                                Utils.showNotification('Produktion gestartet', 'success');
                            }
                        }
                    ]);
            },
            
            printProductionPlan() {
                Utils.showNotification('Druckfunktion in Entwicklung', 'info');
            }
        };

        // ===== RECIPES MODULE =====
        const Recipes = {
            init() {
                this.loadFlavors();
                this.setupEventListeners();
                this.loadRecipes();
            },
            
            loadFlavors() {
                // This would typically load from database
                const flavors = ['Vanille', 'Schokolade', 'Erdbeer', 'Zitrone', 'Stracciatella'];
                const select = document.getElementById('recipe-flavor');
                select.innerHTML = '<option value="">Sorte ausw√§hlen...</option>';
                
                flavors.forEach(flavor => {
                    const option = document.createElement('option');
                    option.value = flavor.toLowerCase();
                    option.textContent = flavor;
                    select.appendChild(option);
                });
            },
            
            setupEventListeners() {
                // New recipe
                document.getElementById('new-recipe').addEventListener('click', () => {
                    this.showRecipeForm();
                });
                
                // Flavor selection
                document.getElementById('recipe-flavor').addEventListener('change', (e) => {
                    if (e.target.value) {
                        this.loadRecipe(e.target.value);
                    }
                });
                
                // Add ingredient
                document.getElementById('add-ingredient').addEventListener('click', () => {
                    this.addIngredient();
                });
                
                // Save recipe
                document.getElementById('save-recipe').addEventListener('click', () => {
                    this.saveRecipe();
                });
                
                // Cancel recipe
                document.getElementById('cancel-recipe').addEventListener('click', () => {
                    this.hideRecipeForm();
                });
            },
            
            showRecipeForm() {
                document.getElementById('recipe-form').style.display = 'block';
                document.getElementById('recipe-list-card').style.display = 'none';
                document.getElementById('recipe-flavor').value = '';
                document.getElementById('recipe-name').value = '';
                document.getElementById('recipe-description').value = '';
                document.getElementById('ingredients-list').innerHTML = '';
                this.addIngredient(); // Add one empty ingredient row
            },
            
            hideRecipeForm() {
                document.getElementById('recipe-form').style.display = 'none';
                document.getElementById('recipe-list-card').style.display = 'block';
            },
            
            loadRecipe(flavorName) {
                const recipes = DB.getRecipes();
                const recipe = recipes.find(r => r.name.toLowerCase() === flavorName.toLowerCase());
                
                if (recipe) {
                    // Populate form
                    document.getElementById('recipe-form').style.display = 'block';
                    document.getElementById('recipe-list-card').style.display = 'none';
                    document.getElementById('recipe-name').value = recipe.name;
                    document.getElementById('recipe-type').value = recipe.type;
                    document.getElementById('recipe-description').value = recipe.description || '';
                    
                    // Load ingredients
                    this.renderIngredients(recipe.ingredients || []);
                } else {
                    // New recipe for this flavor
                    document.getElementById('recipe-form').style.display = 'block';
                    document.getElementById('recipe-list-card').style.display = 'none';
                    document.getElementById('recipe-name').value = flavorName.charAt(0).toUpperCase() + flavorName.slice(1);
                    document.getElementById('ingredients-list').innerHTML = '';
                    this.addIngredient();
                }
            },
            
            addIngredient() {
                const container = document.getElementById('ingredients-list');
                const index = container.children.length;
                
                const div = document.createElement('div');
                div.className = 'd-flex gap-3 mb-3';
                div.innerHTML = `
                    <select class="form-select ingredient-name" style="flex: 2;">
                        <option value="">Zutat w√§hlen...</option>
                        <option value="vollmilch">Vollmilch 3,5%</option>
                        <option value="zucker">Zucker</option>
                        <option value="sahne">Sahne</option>
                        <option value="eigelb">Eigelb</option>
                        <option value="vanille">Vanilleextrakt</option>
                    </select>
                    <input type="number" class="form-input ingredient-quantity" placeholder="Menge" value="100" min="1">
                    <select class="form-select ingredient-unit">
                        <option value="g">g</option>
                        <option value="ml">ml</option>
                        <option value="stk">Stk</option>
                    </select>
                    <button class="btn btn-danger btn-sm remove-ingredient">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                
                container.appendChild(div);
                
                // Add event listener for removal
                div.querySelector('.remove-ingredient').addEventListener('click', () => {
                    div.remove();
                    this.calculateNutrition();
                });
                
                // Add event listener for ingredient change
                div.querySelector('.ingredient-name').addEventListener('change', () => {
                    this.calculateNutrition();
                });
                
                div.querySelector('.ingredient-quantity').addEventListener('change', () => {
                    this.calculateNutrition();
                });
                
                // Calculate nutrition
                this.calculateNutrition();
            },
            
            renderIngredients(ingredients) {
                const container = document.getElementById('ingredients-list');
                container.innerHTML = '';
                
                ingredients.forEach(ingredient => {
                    const div = document.createElement('div');
                    div.className = 'd-flex gap-3 mb-3';
                    div.innerHTML = `
                        <select class="form-select ingredient-name" style="flex: 2;">
                            <option value="">Zutat w√§hlen...</option>
                            <option value="vollmilch" ${ingredient.name === 'vollmilch' ? 'selected' : ''}>Vollmilch 3,5%</option>
                            <option value="zucker" ${ingredient.name === 'zucker' ? 'selected' : ''}>Zucker</option>
                            <option value="sahne" ${ingredient.name === 'sahne' ? 'selected' : ''}>Sahne</option>
                            <option value="eigelb" ${ingredient.name === 'eigelb' ? 'selected' : ''}>Eigelb</option>
                            <option value="vanille" ${ingredient.name === 'vanille' ? 'selected' : ''}>Vanilleextrakt</option>
                        </select>
                        <input type="number" class="form-input ingredient-quantity" 
                               value="${ingredient.quantity || 100}" min="1">
                        <select class="form-select ingredient-unit">
                            <option value="g" ${ingredient.unit === 'g' ? 'selected' : ''}>g</option>
                            <option value="ml" ${ingredient.unit === 'ml' ? 'selected' : ''}>ml</option>
                            <option value="stk" ${ingredient.unit === 'stk' ? 'selected' : ''}>Stk</option>
                        </select>
                        <button class="btn btn-danger btn-sm remove-ingredient">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    
                    container.appendChild(div);
                    
                    // Add event listeners
                    div.querySelector('.remove-ingredient').addEventListener('click', () => {
                        div.remove();
                        this.calculateNutrition();
                    });
                    
                    div.querySelector('.ingredient-name').addEventListener('change', () => {
                        this.calculateNutrition();
                    });
                    
                    div.querySelector('.ingredient-quantity').addEventListener('change', () => {
                        this.calculateNutrition();
                    });
                });
                
                this.calculateNutrition();
            },
            
            calculateNutrition() {
                // This is a simplified calculation
                // In a real app, you would lookup nutrition data for each ingredient
                
                let totalWeight = 0;
                let totalEnergyKj = 0;
                let totalEnergyKcal = 0;
                let totalFat = 0;
                let totalCarbs = 0;
                let totalProtein = 0;
                
                document.querySelectorAll('.ingredient-row').forEach(row => {
                    const quantity = parseFloat(row.querySelector('.ingredient-quantity').value) || 0;
                    totalWeight += quantity;
                    
                    // Simplified nutrition values per 100g
                    // These would come from a database in a real app
                    totalEnergyKj += quantity * 250; // Example value
                    totalEnergyKcal += quantity * 60; // Example value
                    totalFat += quantity * 3.5;
                    totalCarbs += quantity * 4.5;
                    totalProtein += quantity * 3.0;
                });
                
                // Calculate per 100g
                const per100g = totalWeight > 0 ? 100 / totalWeight : 0;
                
                const nutritionGrid = document.getElementById('nutrition-values');
                nutritionGrid.innerHTML = `
                    <div class="nutrition-item">
                        <div class="nutrition-label">Energie (kJ)</div>
                        <div class="nutrition-value">${Math.round(totalEnergyKj * per100g / 100)}</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Energie (kcal)</div>
                        <div class="nutrition-value">${Math.round(totalEnergyKcal * per100g / 100)}</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Fett</div>
                        <div class="nutrition-value">${(totalFat * per100g / 100).toFixed(1)}g</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Kohlenhydrate</div>
                        <div class="nutrition-value">${(totalCarbs * per100g / 100).toFixed(1)}g</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Eiwei√ü</div>
                        <div class="nutrition-value">${(totalProtein * per100g / 100).toFixed(1)}g</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-label">Gesamtgewicht</div>
                        <div class="nutrition-value">${totalWeight.toFixed(0)}g</div>
                    </div>
                `;
            },
            
            saveRecipe() {
                const name = document.getElementById('recipe-name').value.trim();
                const type = document.getElementById('recipe-type').value;
                const description = document.getElementById('recipe-description').value.trim();
                
                if (!name) {
                    Utils.showNotification('Bitte geben Sie einen Namen f√ºr das Rezept ein', 'warning');
                    return;
                }
                
                // Collect ingredients
                const ingredients = [];
                document.querySelectorAll('#ingredients-list > div').forEach(div => {
                    const name = div.querySelector('.ingredient-name').value;
                    const quantity = parseFloat(div.querySelector('.ingredient-quantity').value) || 0;
                    const unit = div.querySelector('.ingredient-unit').value;
                    
                    if (name && quantity > 0) {
                        ingredients.push({ name, quantity, unit });
                    }
                });
                
                if (ingredients.length === 0) {
                    Utils.showNotification('Bitte f√ºgen Sie mindestens eine Zutat hinzu', 'warning');
                    return;
                }
                
                // Create recipe object
                const recipe = {
                    name,
                    type,
                    description,
                    ingredients,
                    created: new Date().toISOString()
                };
                
                // Save to database
                if (DB.saveRecipe(recipe)) {
                    Utils.showNotification('Rezept erfolgreich gespeichert', 'success');
                    this.hideRecipeForm();
                    this.loadRecipes();
                } else {
                    Utils.showNotification('Fehler beim Speichern des Rezepts', 'danger');
                }
            },
            
            loadRecipes() {
                const recipes = DB.getRecipes();
                const container = document.getElementById('recipes-list');
                container.innerHTML = '';
                
                recipes.forEach(recipe => {
                    const card = document.createElement('div');
                    card.className = 'ingredient-card';
                    card.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="ingredient-name">${recipe.name}</div>
                            <div class="d-flex gap-1">
                                <button class="btn-icon edit-recipe" data-id="${recipe.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon delete-recipe" data-id="${recipe.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="ingredient-meta">
                            <span class="badge badge-primary">${recipe.type}</span>
                            <span class="badge badge-success">${recipe.ingredients?.length || 0} Zutaten</span>
                        </div>
                        <div class="nutrition-grid">
                            <div class="nutrition-item">
                                <div class="nutrition-label">Erstellt</div>
                                <div class="nutrition-value">${Utils.formatDate(recipe.created)}</div>
                            </div>
                        </div>
                        ${recipe.description ? `<div class="mt-2 text-muted fs-sm">${recipe.description}</div>` : ''}
                    `;
                    
                    container.appendChild(card);
                });
                
                // Add event listeners
                this.addRecipeActionListeners();
            },
            
            addRecipeActionListeners() {
                // Edit recipe
                document.querySelectorAll('.edit-recipe').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const recipeId = e.target.closest('button').getAttribute('data-id');
                        this.editRecipe(recipeId);
                    });
                });
                
                // Delete recipe
                document.querySelectorAll('.delete-recipe').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const recipeId = e.target.closest('button').getAttribute('data-id');
                        this.deleteRecipe(recipeId);
                    });
                });
            },
            
            editRecipe(recipeId) {
                Utils.showNotification('Bearbeitungsfunktion in Entwicklung', 'info');
            },
            
            deleteRecipe(recipeId) {
                Utils.showModal('Rezept l√∂schen',
                    'Sind Sie sicher, dass Sie dieses Rezept l√∂schen m√∂chten? Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden.',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'delete',
                            label: 'L√∂schen',
                            type: 'danger',
                            onClick: () => {
                                const recipes = DB.getRecipes();
                                const filtered = recipes.filter(r => r.id !== recipeId);
                                DB.set(DB.KEYS.RECIPES, filtered);
                                this.loadRecipes();
                                Utils.showNotification('Rezept gel√∂scht', 'success');
                            }
                        }
                    ]);
            }
        };

        // ===== LABELS MODULE =====
        const Labels = {
            init() {
                this.loadFlavors();
                this.setDefaultDates();
                this.setupEventListeners();
                this.loadRecentLabels();
            },
            
            loadFlavors() {
                const flavors = ['Vanille', 'Schokolade', 'Erdbeer', 'Zitrone', 'Stracciatella'];
                const select = document.getElementById('label-flavor');
                select.innerHTML = '<option value="">Sorte ausw√§hlen...</option>';
                
                flavors.forEach(flavor => {
                    const option = document.createElement('option');
                    option.value = flavor.toLowerCase();
                    option.textContent = flavor;
                    select.appendChild(option);
                });
            },
            
            setDefaultDates() {
                const today = new Date();
                const todayStr = today.toISOString().split('T')[0];
                
                // Set expiry date to 6 months from now
                const expiry = new Date();
                expiry.setMonth(expiry.getMonth() + 6);
                const expiryStr = expiry.toISOString().split('T')[0];
                
                document.getElementById('label-expiry').value = expiryStr;
                
                // Set batch number
                const batchNumber = `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}-001`;
                document.getElementById('label-batch').value = batchNumber;
            },
            
            setupEventListeners() {
                // Generate label preview
                document.getElementById('generate-label').addEventListener('click', () => {
                    this.generateLabelPreview();
                });
                
                // Print single label
                document.getElementById('print-label').addEventListener('click', () => {
                    this.printLabel();
                });
                
                // Print batch
                document.getElementById('print-batch').addEventListener('click', () => {
                    this.printBatch();
                });
                
                // Export as PDF
                document.getElementById('export-label').addEventListener('click', () => {
                    this.exportLabel();
                });
            },
            
            generateLabelPreview() {
                const flavor = document.getElementById('label-flavor').value;
                const size = document.getElementById('label-size').value;
                const batch = document.getElementById('label-batch').value;
                const expiry = document.getElementById('label-expiry').value;
                const notes = document.getElementById('label-notes').value;
                
                if (!flavor) {
                    Utils.showNotification('Bitte eine Sorte ausw√§hlen', 'warning');
                    return;
                }
                
                // Format expiry date
                const expiryDate = new Date(expiry);
                const expiryFormatted = expiryDate.toLocaleDateString('de-DE');
                
                // Generate label HTML
                const labelPreview = document.getElementById('label-preview');
                labelPreview.innerHTML = `
                    <div style="border: 2px solid #333; padding: 20px; border-radius: 8px; background: white; max-width: 400px; margin: 0 auto; font-family: Arial, sans-serif;">
                        <div style="text-align: center; border-bottom: 1px solid #ccc; padding-bottom: 10px; margin-bottom: 15px;">
                            <div style="font-size: 18px; font-weight: bold; color: #1f2937;">
                                MILCHEIS - ${flavor.toUpperCase()}
                            </div>
                            <div style="font-size: 12px; color: #666; margin-top: 5px;">
                                Nettof√ºllmenge: <strong>${size} g</strong>
                            </div>
                        </div>
                        
                        <div style="font-size: 11px; line-height: 1.4; color: #374151;">
                            <div style="margin-bottom: 8px;">
                                <strong>Zutaten:</strong> Vollmilch, Sahne, Zucker, Eigelb, nat√ºrliches Aroma
                            </div>
                            
                            <div style="margin-bottom: 8px;">
                                <strong>Allergene:</strong> Milch, Ei
                            </div>
                            
                            ${notes ? `<div style="margin-bottom: 8px;"><strong>Hinweise:</strong> ${notes}</div>` : ''}
                            
                            <div style="margin-bottom: 8px;">
                                <strong>MHD:</strong> ${expiryFormatted}
                            </div>
                            
                            <div style="margin-bottom: 8px;">
                                <strong>Charge:</strong> ${batch}
                            </div>
                            
                            <div style="margin-bottom: 8px;">
                                <strong>N√§hrwerte je 100 g:</strong><br>
                                Energie: 850 kJ / 203 kcal<br>
                                Fett: 8.5 g (davon ges√§ttigt: 5.2 g)<br>
                                Kohlenhydrate: 25 g (davon Zucker: 22 g)<br>
                                Eiwei√ü: 3.8 g<br>
                                Salz: 0.12 g
                            </div>
                            
                            <div style="margin-top: 12px; padding-top: 10px; border-top: 1px solid #ccc; font-size: 10px; color: #6b7280;">
                                <strong>Aufbewahrung:</strong> Bei -18¬∞C lagern. Nach dem Auftauen nicht wieder einfrieren.
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px solid #ccc;">
                            <div style="font-size: 10px; color: #6b7280;">
                                Eiscaf√© Sanremo ‚Ä¢ Bad Berleburg ‚Ä¢ Tel: 0176 72809926
                            </div>
                        </div>
                    </div>
                `;
                
                // Show label preview card
                document.getElementById('label-preview-card').style.display = 'block';
                
                // Check for warnings
                this.checkWarnings(flavor);
            },
            
            checkWarnings(flavor) {
                // This would check for allergens, special ingredients, etc.
                const warnings = [];
                
                // Example warnings
                if (flavor === 'schokolade') {
                    warnings.push('Enth√§lt Kakaopulver');
                }
                
                if (document.getElementById('label-size').value === '170') {
                    warnings.push('Kleine Verpackung - besondere Kennzeichnung pr√ºfen');
                }
                
                // Show warnings if any
                if (warnings.length > 0) {
                    const warningContent = document.getElementById('warning-content');
                    warningContent.innerHTML = '<strong>Warnungen:</strong><br>' + warnings.join('<br>');
                    document.getElementById('label-warnings').style.display = 'flex';
                } else {
                    document.getElementById('label-warnings').style.display = 'none';
                }
            },
            
            printLabel() {
                Utils.showNotification('Etikett wird gedruckt...', 'info');
                // In a real app, this would trigger the print dialog
                setTimeout(() => {
                    Utils.showNotification('Etikett erfolgreich gedruckt', 'success');
                    this.saveLabelToHistory();
                }, 1000);
            },
            
            printBatch() {
                Utils.showModal('Charge drucken',
                    'M√∂chten Sie 10 identische Etiketten f√ºr diese Charge drucken?',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'print',
                            label: '10x Drucken',
                            type: 'primary',
                            onClick: () => {
                                Utils.showNotification('10 Etiketten werden gedruckt...', 'info');
                                setTimeout(() => {
                                    Utils.showNotification('Charge erfolgreich gedruckt', 'success');
                                    this.saveLabelToHistory(10);
                                }, 2000);
                            }
                        }
                    ]);
            },
            
            exportLabel() {
                Utils.showNotification('Exportfunktion in Entwicklung', 'info');
            },
            
            saveLabelToHistory(quantity = 1) {
                // Save label printing to history
                const history = DB.get(DB.KEYS.STATISTICS);
                const labelData = {
                    id: Utils.generateId(),
                    date: new Date().toISOString(),
                    flavor: document.getElementById('label-flavor').value,
                    size: document.getElementById('label-size').value,
                    batch: document.getElementById('label-batch').value,
                    quantity: quantity,
                    type: 'label_print'
                };
                
                history.push(labelData);
                DB.set(DB.KEYS.STATISTICS, history);
                
                // Reload recent labels
                this.loadRecentLabels();
            },
            
            loadRecentLabels() {
                const history = DB.get(DB.KEYS.STATISTICS);
                const labelHistory = history.filter(h => h.type === 'label_print')
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 10);
                
                const tbody = document.getElementById('recent-labels');
                tbody.innerHTML = '';
                
                labelHistory.forEach(record => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${Utils.formatDate(record.date, true)}</td>
                        <td>${record.flavor}</td>
                        <td>${record.size} g</td>
                        <td>${record.batch}</td>
                        <td>${record.quantity}x</td>
                        <td>
                            <button class="btn btn-sm btn-outline reprint-label" data-id="${record.id}">
                                <i class="fas fa-print"></i> Erneut drucken
                            </button>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
                
                // Add reprint listeners
                document.querySelectorAll('.reprint-label').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const labelId = e.target.closest('button').getAttribute('data-id');
                        this.reprintLabel(labelId);
                    });
                });
            },
            
            reprintLabel(labelId) {
                Utils.showNotification('Etikett wird erneut gedruckt...', 'info');
            }
        };

        // ===== CUSTOMERS MODULE =====
        const Customers = {
            init() {
                this.setupEventListeners();
                this.loadCustomers();
            },
            
            setupEventListeners() {
                // Save customer
                document.getElementById('save-customer').addEventListener('click', () => {
                    this.saveCustomer();
                });
                
                // Clear form
                document.getElementById('clear-customer-form').addEventListener('click', () => {
                    this.clearCustomerForm();
                });
            },
            
            saveCustomer() {
                const name = document.getElementById('customer-name').value.trim();
                const location = document.getElementById('customer-location').value.trim();
                const contact = document.getElementById('customer-contact').value.trim();
                const phone = document.getElementById('customer-phone').value.trim();
                const email = document.getElementById('customer-email').value.trim();
                const type = document.getElementById('customer-type').value;
                const notes = document.getElementById('customer-notes').value.trim();
                
                if (!name) {
                    Utils.showNotification('Bitte geben Sie einen Kundennamen ein', 'warning');
                    return;
                }
                
                // Create customer object
                const customer = {
                    name,
                    location,
                    contact,
                    phone,
                    email,
                    type,
                    notes,
                    created: new Date().toISOString()
                };
                
                // Save to database
                if (DB.saveCustomer(customer)) {
                    Utils.showNotification('Kunde erfolgreich gespeichert', 'success');
                    this.clearCustomerForm();
                    this.loadCustomers();
                    
                    // Reload customer dropdown in orders module
                    Orders.loadCustomers();
                } else {
                    Utils.showNotification('Fehler beim Speichern des Kunden', 'danger');
                }
            },
            
            clearCustomerForm() {
                document.getElementById('customer-name').value = '';
                document.getElementById('customer-location').value = '';
                document.getElementById('customer-contact').value = '';
                document.getElementById('customer-phone').value = '';
                document.getElementById('customer-email').value = '';
                document.getElementById('customer-type').value = 'supermarkt';
                document.getElementById('customer-notes').value = '';
            },
            
            loadCustomers() {
                const customers = DB.getCustomers();
                const tbody = document.getElementById('customers-list');
                tbody.innerHTML = '';
                
                customers.forEach(customer => {
                    // Find last order date
                    const orders = DB.getOrders();
                    const customerOrders = orders.filter(o => o.customerId === customer.id);
                    const lastOrder = customerOrders.length > 0 ? 
                        Utils.formatDate(Math.max(...customerOrders.map(o => new Date(o.date)))) : 
                        'Noch keine';
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${customer.name}</strong></td>
                        <td>${customer.location}</td>
                        <td>${customer.contact}</td>
                        <td>
                            <span class="badge badge-primary">${customer.type}</span>
                        </td>
                        <td>${lastOrder}</td>
                        <td>
                            <div class="table-actions">
                                <button class="btn-icon edit-customer" data-id="${customer.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon delete-customer" data-id="${customer.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
                
                // Add event listeners
                this.addCustomerActionListeners();
            },
            
            addCustomerActionListeners() {
                // Edit customer
                document.querySelectorAll('.edit-customer').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const customerId = e.target.closest('button').getAttribute('data-id');
                        this.editCustomer(customerId);
                    });
                });
                
                // Delete customer
                document.querySelectorAll('.delete-customer').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const customerId = e.target.closest('button').getAttribute('data-id');
                        this.deleteCustomer(customerId);
                    });
                });
            },
            
            editCustomer(customerId) {
                const customers = DB.getCustomers();
                const customer = customers.find(c => c.id === customerId);
                
                if (customer) {
                    // Populate form
                    document.getElementById('customer-name').value = customer.name;
                    document.getElementById('customer-location').value = customer.location;
                    document.getElementById('customer-contact').value = customer.contact;
                    document.getElementById('customer-phone').value = customer.phone;
                    document.getElementById('customer-email').value = customer.email;
                    document.getElementById('customer-type').value = customer.type;
                    document.getElementById('customer-notes').value = customer.notes || '';
                    
                    // Scroll to form
                    document.getElementById('customer-name').scrollIntoView({ behavior: 'smooth' });
                    
                    Utils.showNotification('Kundendaten geladen. Bearbeiten und speichern Sie die √Ñnderungen.', 'info');
                }
            },
            
            deleteCustomer(customerId) {
                Utils.showModal('Kunde l√∂schen',
                    'Sind Sie sicher, dass Sie diesen Kunden l√∂schen m√∂chten? Alle zugeh√∂rigen Bestellungen bleiben erhalten, k√∂nnen aber diesem Kunden nicht mehr zugeordnet werden.',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'delete',
                            label: 'L√∂schen',
                            type: 'danger',
                            onClick: () => {
                                if (DB.deleteCustomer(customerId)) {
                                    Utils.showNotification('Kunde gel√∂scht', 'success');
                                    this.loadCustomers();
                                    Orders.loadCustomers();
                                } else {
                                    Utils.showNotification('Fehler beim L√∂schen des Kunden', 'danger');
                                }
                            }
                        }
                    ]);
            }
        };

        // ===== STATISTICS MODULE =====
        const Statistics = {
            init() {
                this.setupEventListeners();
                this.loadStatistics();
            },
            
            setupEventListeners() {
                // Period selection
                document.getElementById('stat-period').addEventListener('change', (e) => {
                    if (e.target.value === 'custom') {
                        document.getElementById('custom-date-range').style.display = 'block';
                    } else {
                        document.getElementById('custom-date-range').style.display = 'none';
                    }
                });
                
                // Generate report
                document.getElementById('generate-report').addEventListener('click', () => {
                    this.generateReport();
                });
                
                // Export report
                document.getElementById('export-report').addEventListener('click', () => {
                    this.exportReport();
                });
                
                // Print report
                document.getElementById('print-report').addEventListener('click', () => {
                    this.printReport();
                });
            },
            
            loadStatistics() {
                // Load flavor statistics
                const flavors = ['Vanille', 'Schokolade', 'Erdbeer', 'Zitrone'];
                const tbody = document.getElementById('flavor-stats');
                tbody.innerHTML = '';
                
                flavors.forEach(flavor => {
                    // Generate random data for demo
                    const quantity = Math.floor(Math.random() * 1000) + 100;
                    const revenue = quantity * 2.5;
                    const percentage = Math.floor(Math.random() * 30) + 10;
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${flavor}</strong></td>
                        <td>${quantity} kg</td>
                        <td>${revenue.toFixed(2)} ‚Ç¨</td>
                        <td>${percentage}%</td>
                        <td>
                            <span class="badge ${percentage > 15 ? 'badge-success' : 'badge-warning'}">
                                ${percentage > 15 ? '‚Üó Steigend' : '‚Üí Stabil'}
                            </span>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
            },
            
            generateReport() {
                const period = document.getElementById('stat-period').value;
                const type = document.getElementById('stat-type').value;
                
                let title = '';
                let data = [];
                
                switch(type) {
                    case 'sales':
                        title = 'Verkaufsstatistik';
                        data = [
                            { metric: 'Gesamtumsatz', value: '2.845,60 ‚Ç¨', change: '+12%', trend: 'positive' },
                            { metric: 'Durchschnitt pro Bestellung', value: '142,28 ‚Ç¨', change: '+5%', trend: 'positive' },
                            { metric: 'Anzahl Bestellungen', value: '20', change: '+15%', trend: 'positive' },
                            { metric: 'Top-Kunde', value: 'REWE', change: '‚Äî', trend: 'neutral' },
                            { metric: 'Return Rate', value: '0,5%', change: '-0,2%', trend: 'positive' }
                        ];
                        break;
                        
                    case 'production':
                        title = 'Produktionsstatistik';
                        data = [
                            { metric: 'Produzierte Menge', value: '456 kg', change: '+8%', trend: 'positive' },
                            { metric: 'Eimer verbraucht', value: '76', change: '+7%', trend: 'positive' },
                            { metric: 'Durchsatz pro Stunde', value: '12,5 kg', change: '+3%', trend: 'positive' },
                            { metric: 'Ausschussquote', value: '1,2%', change: '-0,3%', trend: 'positive' },
                            { metric: 'Energieverbrauch', value: '245 kWh', change: '+2%', trend: 'warning' }
                        ];
                        break;
                        
                    case 'customers':
                        title = 'Kundenstatistik';
                        data = [
                            { metric: 'Aktive Kunden', value: '15', change: '+2', trend: 'positive' },
                            { metric: 'Neue Kunden', value: '3', change: '+1', trend: 'positive' },
                            { metric: 'Durchschnittlicher Auftragswert', value: '189,71 ‚Ç¨', change: '+14%', trend: 'positive' },
                            { metric: 'Kundenbindungsrate', value: '92%', change: '+3%', trend: 'positive' },
                            { metric: 'Response Time', value: '2,4 h', change: '-0,6 h', trend: 'positive' }
                        ];
                        break;
                }
                
                // Render statistics
                const tbody = document.getElementById('statistics-data');
                tbody.innerHTML = '';
                
                data.forEach(item => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${item.metric}</strong></td>
                        <td>${item.value}</td>
                        <td>${item.change}</td>
                        <td>
                            <span class="badge ${item.trend === 'positive' ? 'badge-success' : item.trend === 'warning' ? 'badge-warning' : 'badge-primary'}">
                                ${item.trend === 'positive' ? 'Positiv' : item.trend === 'warning' ? 'Achtung' : 'Neutral'}
                            </span>
                        </td>
                        <td>
                            <button class="btn-icon">
                                <i class="fas fa-chart-line"></i>
                            </button>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
                
                Utils.showNotification(`${title} f√ºr ${period} generiert`, 'success');
            },
            
            exportReport() {
                Utils.showNotification('Exportfunktion in Entwicklung', 'info');
            },
            
            printReport() {
                Utils.showNotification('Druckfunktion in Entwicklung', 'info');
            }
        };

        // ===== SETTINGS MODULE =====
        const Settings = {
            init() {
                this.loadSettings();
                this.setupEventListeners();
            },
            
            loadSettings() {
                const settings = DB.getSettings();
                
                // Populate form
                document.getElementById('company-name').value = settings.company_name || '';
                document.getElementById('company-address').value = settings.company_address || '';
                document.getElementById('company-phone').value = settings.company_phone || '';
                
                if (settings.sizes && settings.sizes.length >= 4) {
                    document.getElementById('size-170').value = settings.sizes[0] || 170;
                    document.getElementById('size-500').value = settings.sizes[1] || 500;
                    document.getElementById('size-750').value = settings.sizes[2] || 750;
                    document.getElementById('size-1000').value = settings.sizes[3] || 1000;
                }
                
                document.getElementById('bucket-size').value = settings.bucket_size || 6;
                document.getElementById('default-expiry').value = settings.default_expiry_days || 180;
                document.getElementById('theme-select').value = settings.theme || 'light';
                document.getElementById('language-select').value = settings.language || 'de';
            },
            
            setupEventListeners() {
                // Save settings
                document.getElementById('save-settings').addEventListener('click', () => {
                    this.saveSettings();
                });
                
                // Backup data
                document.getElementById('backup-data').addEventListener('click', () => {
                    this.backupData();
                });
                
                // Restore data
                document.getElementById('restore-data').addEventListener('click', () => {
                    this.restoreData();
                });
                
                // Reset data
                document.getElementById('reset-data').addEventListener('click', () => {
                    this.resetData();
                });
                
                // Theme change
                document.getElementById('theme-select').addEventListener('change', (e) => {
                    this.applyTheme(e.target.value);
                });
            },
            
            saveSettings() {
                const settings = {
                    company_name: document.getElementById('company-name').value.trim(),
                    company_address: document.getElementById('company-address').value.trim(),
                    company_phone: document.getElementById('company-phone').value.trim(),
                    sizes: [
                        parseInt(document.getElementById('size-170').value) || 170,
                        parseInt(document.getElementById('size-500').value) || 500,
                        parseInt(document.getElementById('size-750').value) || 750,
                        parseInt(document.getElementById('size-1000').value) || 1000
                    ],
                    bucket_size: parseFloat(document.getElementById('bucket-size').value) || 6,
                    default_expiry_days: parseInt(document.getElementById('default-expiry').value) || 180,
                    theme: document.getElementById('theme-select').value,
                    language: document.getElementById('language-select').value
                };
                
                if (DB.saveSettings(settings)) {
                    Utils.showNotification('Einstellungen erfolgreich gespeichert', 'success');
                    
                    // Apply theme immediately
                    this.applyTheme(settings.theme);
                } else {
                    Utils.showNotification('Fehler beim Speichern der Einstellungen', 'danger');
                }
            },
            
            applyTheme(theme) {
                const root = document.documentElement;
                
                if (theme === 'dark') {
                    root.style.setProperty('--light', '#1f2937');
                    root.style.setProperty('--card-bg', '#374151');
                    root.style.setProperty('--dark', '#f9fafb');
                    root.style.setProperty('--muted', '#9ca3af');
                    root.style.setProperty('--border', '#4b5563');
                } else {
                    root.style.setProperty('--light', '#f9fafb');
                    root.style.setProperty('--card-bg', '#ffffff');
                    root.style.setProperty('--dark', '#1f2937');
                    root.style.setProperty('--muted', '#6b7280');
                    root.style.setProperty('--border', '#e5e7eb');
                }
            },
            
            backupData() {
                const backup = DB.backup();
                const blob = new Blob([backup], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `sanremo-backup-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                
                URL.revokeObjectURL(url);
                
                Utils.showNotification('Backup erfolgreich erstellt', 'success');
            },
            
            restoreData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const backupData = event.target.result;
                        
                        Utils.showModal('Backup wiederherstellen',
                            'Sind Sie sicher, dass Sie das Backup wiederherstellen m√∂chten? Alle aktuellen Daten werden √ºberschrieben.',
                            [
                                {
                                    id: 'cancel',
                                    label: 'Abbrechen',
                                    type: 'outline',
                                    onClick: () => {}
                                },
                                {
                                    id: 'restore',
                                    label: 'Wiederherstellen',
                                    type: 'danger',
                                    onClick: () => {
                                        if (DB.restore(backupData)) {
                                            Utils.showNotification('Backup erfolgreich wiederhergestellt', 'success');
                                            location.reload(); // Reload to apply changes
                                        } else {
                                            Utils.showNotification('Fehler beim Wiederherstellen des Backups', 'danger');
                                        }
                                    }
                                }
                            ]);
                    };
                    
                    reader.readAsText(file);
                };
                
                input.click();
            },
            
            resetData() {
                Utils.showModal('Daten zur√ºcksetzen',
                    'Sind Sie sicher, dass Sie alle Daten zur√ºcksetzen m√∂chten? Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden. Erstellen Sie vorher ein Backup.',
                    [
                        {
                            id: 'cancel',
                            label: 'Abbrechen',
                            type: 'outline',
                            onClick: () => {}
                        },
                        {
                            id: 'reset',
                            label: 'Alle Daten zur√ºcksetzen',
                            type: 'danger',
                            onClick: () => {
                                // Clear all data
                                localStorage.clear();
                                
                                // Reinitialize
                                DB.init();
                                
                                Utils.showNotification('Alle Daten wurden zur√ºckgesetzt', 'success');
                                
                                // Reload page
                                setTimeout(() => location.reload(), 2000);
                            }
                        }
                    ]);
            }
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize database
            DB.init();
            
            // Initialize view manager
            ViewManager.init();
            
            // Set initial theme
            const settings = DB.getSettings();
            Settings.applyTheme(settings.theme || 'light');
            
            // Auto-save indicator
            let saveTimeout;
            document.addEventListener('input', () => {
                clearTimeout(saveTimeout);
                const status = document.getElementById('data-status');
                status.textContent = '√Ñnderungen...';
                status.className = 'badge badge-warning';
                
                saveTimeout = setTimeout(() => {
                    status.textContent = 'Daten gespeichert';
                    status.className = 'badge badge-success';
                }, 1000);
            });
            
            // Initialize date inputs with today's date
            const today = new Date().toISOString().split('T')[0];
            document.querySelectorAll('input[type="date"]').forEach(input => {
                if (!input.value) {
                    input.value = today;
                }
            });
            
            console.log('Sanremo Eisproduktionssystem gestartet');
        });
    </script>
</body>
  </html>
